
{
"name":"ivre",
"description":"Install IVRE Framework (https://github.com/ivre/ivre) Client, Database and Web Dashboard",
"install": [
"sudo apt-get -q update",
"sudo apt-get -qy --no-install-recommends install python3-pymongo mongodb python3-crypto python3-bottle libapache2-mod-wsgi-py3 python3-cryptography python3-setuptools python3-bottle python3-openssl ca-certificates git -y",
"git clone https://github.com/ivre/ivre",
"cd ivre/ && python3 setup.py build && sudo python3 setup.py install && cd /home/op/",
"sudo apt-get -qy --no-install-recommends install rsync screen ipython3 openssl tesseract-ocr libfreetype6 libfontconfig1 fonts-dejavu imagemagick ffmpeg s3270 patch bash-completion bzip2 python3-pil nfdump python3-pymongo  python3-crypto python3-bottle apache2 libapache2-mod-wsgi-py3 ",
"sudo service apache2 stop",
"wget https://nmap.org/dist/nmap-7.92.tgz -O nmap.tar.gz",
"sudo apt-get -qy --no-install-recommends install build-essential libssl-dev flex bison",
"tar zxf nmap.tar.gz  && cd nmap-7.92",
"sudo ./configure --without-ndiff --without-zenmap --without-nping  --without-ncat --without-nmap-update    --with-libpcap=included && sudo make && sudo make install && cd /home/op",
"sudo apt-get -qy --no-install-recommends install gnupg wget",
"echo 'deb http://download.opensuse.org/repositories/security:/zeek/Debian_11/ /' | sudo tee -a /etc/apt/sources.list.d/zeek.list",
"wget -qO - https://download.opensuse.org/repositories/security:zeek/Debian_11/Release.key | sudo apt-key add - ",
"sudo apt-get -q update && sudo apt-get -qy --no-install-recommends install zeek",
"wget https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-1.9.8-linux-x86_64.tar.bz2 && tar jxf phantomjs-1.9.8-linux-x86_64.tar.bz2 phantomjs-1.9.8-linux-x86_64/bin/phantomjs",
"sudo mv phantomjs-1.9.8-linux-x86_64/bin/phantomjs /usr/local/bin/",
"sudo cp /home/op/ivre/nmap_scripts/* /usr/local/share/nmap/scripts",
"sudo cp /home/op/ivre/nmap_scripts/* /home/op/nmap-7.92/scripts",
"cd /home/op/nmap-7.92/ && sudo ./nmap --script-update",
"sudo nmap --script-update",
"sudo apt-get -qy --no-install-recommends install gnupg wget ca-certificates",
"sudo apt-get -qy --no-install-recommends install nginx spawn-fcgi php-fpm php-gd fcgiwrap uwsgi-plugin-python3",
"curl https://raw.githubusercontent.com/ivre/ivre/master/docker/web/nginx-default-site | sudo tee /etc/nginx/sites-available/default",
"sudo mkdir /var/run/uwsgi",
"wget http://download.dokuwiki.org/src/dokuwiki/dokuwiki-stable.tgz",
"tar -zxf dokuwiki-stable.tgz",
"sudo mv dokuwiki-2020-07-29 /var/www/dokuwiki",
"sudo apt-get -qy --no-install-recommends install patch",
"sudo patch /var/www/dokuwiki/inc/html.php /usr/local/share/ivre/dokuwiki/backlinks.patch",
"sudo ln -s /usr/local/share/ivre/dokuwiki/doc /var/www/dokuwiki/data/pages/doc",
"sudo ln -s /usr/local/share/ivre/dokuwiki/media/logo.png /var/www/dokuwiki/data/media/wiki/logo.png",
"sudo mkdir var/www/dokuwiki/data/media/doc",
"sudo ln -s /usr/local/share/doc/ivre/screenshots /var/www/dokuwiki/data/media/doc/",
"sudo ln -s /usr/local/share/ivre/dokuwiki/media/doc /var/www/dokuwiki/data/media/wiki/doc",
"sudo echo 'WEB_GET_NOTEPAD_PAGES = (\"localdokuwiki\", (\"/var/www/dokuwiki/data/pages\",))' | sudo tee -a /etc/ivre.conf",
"sudo rm var/www/dokuwiki/install.php",
"curl https://raw.githubusercontent.com/ivre/ivre/master/docker/web/doku-conf-local.php | sudo tee -a /var/www/dokuwiki/conf/local.php",
"curl https://raw.githubusercontent.com/ivre/ivre/master/docker/web/doku-conf-plugins.local.php | sudo tee -a /var/www/dokuwiki/conf/plugins.local.php",
"curl https://raw.githubusercontent.com/ivre/ivre/master/docker/web/doku-conf-acl.auth.php | sudo tee -a /var/www/dokuwiki/conf/acl.auth.php",
"curl https://raw.githubusercontent.com/ivre/ivre/master/docker/web/doku-conf-users.auth.php | sudo tee -a /var/www/dokuwiki/conf/users.auth.php",
"sudo chown -Rh www-data:www-data /var/www/dokuwiki/data /var/www/dokuwiki/conf /var/www/dokuwiki/lib/plugins",
"sudo chown -Rh op:www-data /var/www/dokuwiki/data /var/www/dokuwiki/conf /var/www/dokuwiki/lib/plugins",
"sudo service php7.4-fpm restart",
"sudo ln -s /var/run/php/php?*-fpm.sock /var/run/php/php-fpm.sock",
"sudo service fcgiwrap restart",
"sudo uwsgi --plugin /usr/lib/uwsgi/plugins/python3_plugin.so  --daemonize /var/log/nginx/uwsgi.log  --socket /var/run/uwsgi/sock   --processes 4 --threads 2  --mount /cgi=/home/op/ivre/web/wsgi/app.wsgi --manage-script-name",
"sudo service nginx stop",
"sudo ufw allow 80",
"yes | ivre ipinfo --init",
"yes | ivre scancli --init",
"yes | ivre view --init",
"yes | ivre flowcli --init",
"yes | sudo ivre runscansagentdb --init",
"sudo ivre ipdata --download",
"sudo /usr/sbin/nginx &",
"echo ''",
"echo 'Testing database by conducting NMAP scan against: scanme.nmap.org"
"nmap scanme.nmap.org -A -T4 -oX scanme",
"echo 'Importing scan result'",
"ivre scan2db scanme",
"ivre db2view nmap",
"echo ''",
"echo 'The IVRE / DRUNK Dynamic Recon of UNKnown networks dashboard is exposed to the public internet at the following IP:'",
"dig @ns1-1.akamaitech.net ANY whoami.akamai.net +short | sed 's/^/http:\\/\\//'"
    ],
    "uninstall":[
        ""
    ],
    "notes":"Install Complete. The web dashbaord is publicly reachable on port 80 for testing. Make sure you can reach the dashboard then SSH into the server and restrict access to port 80 with ufw"
}
